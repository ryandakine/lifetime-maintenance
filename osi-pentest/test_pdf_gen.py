#!/usr/bin/env python3
"""Test PDF Generation"""

from osi_doc_generator import OSIDocumentGenerator
from datetime import datetime

print("üß™ Testing OSI Document Generator...")

# Initialize
doc_gen = OSIDocumentGenerator()

# Test 1: Invoice
print("\n1Ô∏è‚É£ Testing Invoice Generation...")
test_client = {
    'name': 'Wayne Enterprises',
    'contact': 'Bruce Wayne',
    'email': 'bruce@wayne.com'
}

test_invoice = {
    'number': 'INV-20260102',
    'date': datetime.now().strftime('%B %d, %Y'),
    'amount': 2500.00,
    'description': 'Monthly Retainer - Tier 2 (Security Partner)'
}

pdf = doc_gen.fill_invoice(test_client, test_invoice)
filepath = doc_gen.save_pdf(pdf, "TEST_Invoice_Wayne_Enterprises.pdf")
print(f"   ‚úÖ Invoice saved to: {filepath}")

# Test 2: NDA
print("\n2Ô∏è‚É£ Testing NDA Generation...")
party1 = {'name': 'On-Site Intelligence LLC'}
party2 = {'name': 'Stark Industries'}

pdf = doc_gen.fill_nda(party1, party2)
filepath = doc_gen.save_pdf(pdf, "TEST_NDA_Stark_Industries.pdf")
print(f"   ‚úÖ NDA saved to: {filepath}")

# Test 3: Statement of Work
print("\n3Ô∏è‚É£ Testing SOW Generation...")
test_project = {
    'name': 'Security Assessment',
    'start_date': 'January 15, 2026',
    'end_date': 'February 15, 2026',
    'duration': '30 days',
    'scope': 'Comprehensive penetration testing of external and internal networks, including web applications and wireless infrastructure.',
    'deliverables': [
        'Executive Summary Report',
        'Detailed Technical Findings',
        'Risk Assessment Matrix',
        'Remediation Recommendations'
    ],
    'amount': 12000.00
}

pdf = doc_gen.fill_sow({'name': 'Acme Corporation'}, test_project)
filepath = doc_gen.save_pdf(pdf, "TEST_SOW_Acme_Corporation.pdf")
print(f"   ‚úÖ SOW saved to: {filepath}")

print("\n‚úÖ All tests passed! PDFs generated successfully.")
print(f"\nüìÅ Check the 'generated_documents' folder for your test PDFs.")
