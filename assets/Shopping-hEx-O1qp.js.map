{"version":3,"file":"Shopping-hEx-O1qp.js","sources":["../../src/components/Shopping.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo } from 'react'\nimport { supabase, TABLES, API_KEYS } from '../lib/supabase'\nimport { \n  ShoppingCart, \n  Search, \n  CheckSquare, \n  Square, \n  Trash2, \n  Plus, \n  Brain,\n  Store,\n  Package,\n  MapPin,\n  RotateCcw,\n  Loader,\n  AlertCircle,\n  CheckCircle,\n  XCircle,\n  ExternalLink,\n  Filter,\n  List,\n  Grid,\n  Mic,\n  Copy,\n  Lightbulb,\n  Droplet,\n  Paintbrush,\n  Wrench,\n  HelpCircle\n} from 'lucide-react'\n\n// Add color palette for Lifetime Fitness look\nconst LIFETIME_COLORS = {\n  primary: '#1a3d2f', // dark green\n  accent: '#bfc1c2',  // silver\n  background: '#f5f6f7',\n  white: '#fff',\n  black: '#222',\n  highlight: '#e6f4ea',\n}\n\nconst Shopping = () => {\n  console.log('Rendering Shopping')\n  const [shoppingLists, setShoppingLists] = useState([])\n  const [tasks, setTasks] = useState([])\n  const [loading, setLoading] = useState(false)\n  const [message, setMessage] = useState({ type: '', text: '' })\n  const [isOnline, setIsOnline] = useState(navigator.onLine)\n  const [userInput, setUserInput] = useState('')\n  const [processing, setProcessing] = useState(false)\n  const [selectedTaskId, setSelectedTaskId] = useState('')\n  const [isListening, setIsListening] = useState(false)\n  const [transcript, setTranscript] = useState('')\n  const recognitionRef = useRef(null)\n  const listeningTimeoutRef = useRef(null)\n  const [activeList, setActiveList] = useState('main') // 'main' or 'misc'\n  const [mainList, setMainList] = useState([])\n  const [miscList, setMiscList] = useState([])\n  const [suggestedItems, setSuggestedItems] = useState([])\n  const [analytics, setAnalytics] = useState({})\n  const [reminder, setReminder] = useState('')\n  const [aiQuery, setAiQuery] = useState('')\n  const [aiResponse, setAiResponse] = useState('')\n  const [aiProcessing, setAiProcessing] = useState(false)\n  const [aiListening, setAiListening] = useState(false)\n  const [aiTranscript, setAiTranscript] = useState('')\n  const aiRecognitionRef = useRef(null)\n  const aiListeningTimeoutRef = useRef(null)\n  const [showVoiceModal, setShowVoiceModal] = useState(false)\n  const [voiceModalText, setVoiceModalText] = useState('')\n  const [voiceModalListening, setVoiceModalListening] = useState(false)\n  const voiceModalRecognitionRef = useRef(null)\n\n  const COMMON_ITEMS = [\n    'LED bulbs',\n    'HVAC filter',\n    'Toilet flapper',\n    'Pipe wrench',\n    'Outlet cover',\n    'Paint roller',\n    'Extension cord',\n    'Concrete patch',\n    'Caulk',\n    'Screws',\n    'Batteries',\n    'WD-40',\n    'Shop towels',\n    'Zip ties',\n    'Wire nuts'\n  ]\n\n  const CATEGORY_KEYWORDS = {\n    Electrical: ['bulb', 'outlet', 'wire', 'extension cord', 'batteries', 'switch'],\n    Plumbing: ['toilet', 'flapper', 'pipe', 'caulk'],\n    Paint: ['paint', 'roller', 'brush'],\n    Tools: ['wrench', 'screwdriver', 'zip ties'],\n    Misc: []\n  }\n  const SUGGESTIONS = {\n    'paint': ['Paint tray', 'Painterâ€™s tape', 'Drop cloth'],\n    'toilet': ['Wax ring', 'Toilet bolts'],\n    'bulb': ['Light fixture', 'Dimmer switch'],\n    'filter': ['Replacement filter', 'Filter cleaner'],\n    'batteries': ['Battery tester'],\n    'outlet': ['Outlet cover', 'GFCI outlet'],\n    'pipe': ['Pipe tape', 'Pipe insulation'],\n    'roller': ['Paint tray liner'],\n    'wrench': ['Pipe wrench', 'Adjustable wrench'],\n  }\n\n  const CATEGORY_ICONS = {\n    Electrical: <Lightbulb size={18} style={{ marginRight: 4 }} />,\n    Plumbing: <Droplet size={18} style={{ marginRight: 4 }} />,\n    Paint: <Paintbrush size={18} style={{ marginRight: 4 }} />,\n    Tools: <Wrench size={18} style={{ marginRight: 4 }} />,\n    Misc: <HelpCircle size={18} style={{ marginRight: 4 }} />\n  }\n\n  // Check online status\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true)\n    const handleOffline = () => setIsOnline(false)\n\n    window.addEventListener('online', handleOnline)\n    window.addEventListener('offline', handleOffline)\n\n    return () => {\n      window.removeEventListener('online', handleOnline)\n      window.removeEventListener('offline', handleOffline)\n    }\n  }, [])\n\n  // Load shopping lists and tasks on component mount\n  useEffect(() => {\n    loadShoppingLists()\n    loadTasks()\n  }, [])\n\n  // On mount, load both lists from localStorage (or Supabase in future)\n  useEffect(() => {\n    const main = JSON.parse(localStorage.getItem('shoppingList_main') || '[]')\n    const misc = JSON.parse(localStorage.getItem('shoppingList_misc') || '[]')\n    setMainList(main)\n    setMiscList(misc)\n  }, [])\n\n  // Save lists to localStorage when they change\n  useEffect(() => {\n    localStorage.setItem('shoppingList_main', JSON.stringify(mainList))\n  }, [mainList])\n  useEffect(() => {\n    localStorage.setItem('shoppingList_misc', JSON.stringify(miscList))\n  }, [miscList])\n\n  // Handle voice commands\n  useEffect(() => {\n    const voiceShopping = localStorage.getItem('voiceShopping')\n    if (voiceShopping) {\n      setUserInput(voiceShopping)\n      localStorage.removeItem('voiceShopping')\n      // Auto-process the voice shopping list\n      setTimeout(() => {\n        processShoppingInput()\n      }, 500)\n    }\n  }, [])\n\n  const loadShoppingLists = async () => {\n    try {\n      setLoading(true)\n      const { data, error } = await supabase\n        .from(TABLES.SHOPPING_LISTS)\n        .select('*')\n        .eq('user_id', 'current-user')\n        .order('created_at', { ascending: false })\n\n      if (error) throw error\n      setShoppingLists(data || [])\n      console.log('Shopping lists loaded:', data?.length || 0)\n    } catch (error) {\n      console.error('Error loading shopping lists:', error)\n      console.log('Shopping component: Data load failed, showing fallback')\n      showMessage('error', 'Failed to load shopping lists')\n      setShoppingLists([]) // Ensure empty state for fallback\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadTasks = async () => {\n    try {\n      const { data, error } = await supabase\n        .from(TABLES.TASKS)\n        .select('id, task_list, status')\n        .eq('user_id', 'current-user')\n        .order('created_at', { ascending: false })\n\n      if (error) throw error\n      setTasks(data || [])\n    } catch (error) {\n      console.error('Error loading tasks:', error)\n    }\n  }\n\n  const processShoppingInput = async () => {\n    if (!userInput.trim()) return\n\n    try {\n      setProcessing(true)\n      const perplexityApiKey = API_KEYS.PERPLEXITY_PRO\n\n      if (!perplexityApiKey || perplexityApiKey === 'your-perplexity-key') {\n        console.warn('Perplexity Pro API key not configured, using fallback parsing')\n        // Fallback: improved parsing for quantity and brand\n        const items = userInput.split('\\n').filter(line => line.trim()).map(itemLine => {\n          // Try to extract quantity and brand\n          const match = itemLine.match(/^(\\d+)\\s+([A-Za-z0-9\\- ]+)?(.*)$/)\n          let quantity = 1\n          let name = itemLine.trim()\n          let brand = ''\n          if (match) {\n            quantity = parseInt(match[1], 10)\n            name = (match[2] + (match[3] || '')).trim()\n          } else {\n            // Try to extract brand if present (e.g., 'GE LED bulb')\n            const brandMatch = itemLine.match(/^(\\w+)\\s+(.+)$/)\n            if (brandMatch) {\n              brand = brandMatch[1]\n              name = brandMatch[2]\n            }\n          }\n          return {\n            name,\n            quantity,\n            brand,\n          grainger_part: 'N/A',\n          grainger_url: '',\n          home_depot_aisle: 'N/A',\n          }\n        })\n        addItemToActiveList(items)\n      } else {\n        // Use Perplexity Pro for AI parsing\n        const response = await fetch('https://api.perplexity.ai/chat/completions', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${perplexityApiKey}`\n          },\n          body: JSON.stringify({\n            model: 'gpt-4',\n            messages: [\n              {\n                role: 'user',\n                content: `Parse the following shopping list and return it in a JSON array of objects. Each object should have 'name', 'quantity', 'brand', 'grainger_part', 'grainger_url', 'home_depot_aisle'. If a part number or URL is not available, set it to 'N/A'. For example: [{\"name\": \"LED bulbs\", \"quantity\": 10, \"brand\": \"GE\", \"grainger_part\": \"123456\", \"grainger_url\": \"https://www.grainger.com/part/123456\", \"home_depot_aisle\": \"Aisle 10\"}, {\"name\": \"HVAC filter\", \"quantity\": 2, \"brand\": \"Honeywell\", \"grainger_part\": \"789012\", \"grainger_url\": \"https://www.grainger.com/part/789012\", \"home_depot_aisle\": \"Aisle 5\"}]`\n              }\n            ]\n          })\n        })\n\n        if (!response.ok) {\n          throw new Error(`Perplexity API error: ${response.statusText}`)\n        }\n\n        const data = await response.json()\n        const messageContent = data.choices[0].message.content\n        const parsedItems = JSON.parse(messageContent)\n        addItemToActiveList(parsedItems)\n      }\n    } catch (error) {\n      console.error('Error processing voice input:', error)\n      showMessage('error', 'Failed to process voice input')\n    } finally {\n      setProcessing(false)\n    }\n  }\n\n  const addItemToActiveList = (items) => {\n    // Auto-categorize and suggest\n    const categorized = items.map(item => {\n      let category = 'Misc'\n      for (const [cat, keywords] of Object.entries(CATEGORY_KEYWORDS)) {\n        if (keywords.some(k => item.name.toLowerCase().includes(k))) {\n          category = cat\n          break\n        }\n      }\n      return { ...item, category }\n    })\n    // AI suggestions\n    let suggestions = []\n    categorized.forEach(item => {\n      for (const [key, suggs] of Object.entries(SUGGESTIONS)) {\n        if (item.name.toLowerCase().includes(key)) {\n          suggestions = [...suggestions, ...suggs]\n        }\n      }\n    })\n    setSuggestedItems(suggestions)\n    // Smart reminders (if item bought >2x in last 30 days)\n    const allItems = [...mainList, ...miscList, ...categorized]\n    const freq = {}\n    allItems.forEach(i => {\n      if (!freq[i.name]) freq[i.name] = 0\n      freq[i.name]++\n    })\n    const frequent = Object.entries(freq).filter(([_, count]) => count > 2).map(([name]) => name)\n    if (frequent.length) setReminder(`Reminder: You often buy ${frequent.join(', ')}. Need again?`)\n    // Analytics\n    const completed = allItems.filter(i => i.checked).length\n    const total = allItems.length\n    const byCategory = {}\n    allItems.forEach(i => {\n      byCategory[i.category] = (byCategory[i.category] || 0) + 1\n    })\n    setAnalytics({ total, completed, byCategory })\n    // Save\n    if (activeList === 'main') {\n      setMainList(prev => [...prev, ...categorized])\n    } else {\n      setMiscList(prev => [...prev, ...categorized])\n    }\n  }\n\n  // Move item to Misc\n  const moveToMisc = (index) => {\n    const item = activeList === 'main' ? mainList[index] : miscList[index]\n    if (activeList === 'main') {\n      setMainList(mainList.filter((_, i) => i !== index))\n      setMiscList(prev => [...prev, item])\n    } else {\n      setMiscList(miscList.filter((_, i) => i !== index))\n      setMainList(prev => [...prev, item])\n    }\n  }\n\n  const showMessage = (type, text) => {\n    setMessage({ type, text })\n    setTimeout(() => setMessage({ type: '', text: '' }), 3000)\n  }\n\n  // --- Smart Shopping Assistant handler ---\n  const handleAiQuery = async () => {\n    if (!aiQuery.trim()) return\n    setAiProcessing(true)\n    setAiResponse('')\n    // Compose a summary of purchase history\n    const allItems = [...mainList, ...miscList]\n    const history = allItems.map(i => `${i.quantity}x ${i.name} (${i.category})`).join(', ')\n    const prompt = `User asked: \"${aiQuery}\". Here is their shopping history: ${history}. Based on this, give a smart, concise answer. If they ask what to buy this month, suggest items they buy often, are seasonal, or are due for replacement. If they ask about low stock, infer from frequency. Reply as a helpful assistant.`\n    try {\n      const perplexityApiKey = API_KEYS.PERPLEXITY_PRO\n      const response = await fetch('https://api.perplexity.ai/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${perplexityApiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4',\n          messages: [\n            { role: 'system', content: 'You are a smart shopping assistant for maintenance and facility supplies.' },\n            { role: 'user', content: prompt }\n          ]\n        })\n      })\n      if (!response.ok) throw new Error('AI API error')\n      const data = await response.json()\n      setAiResponse(data.choices[0].message.content)\n    } catch (e) {\n      setAiResponse('Sorry, I could not process your request.')\n    } finally {\n      setAiProcessing(false)\n    }\n  }\n\n  // Voice input for Smart Shopping Assistant\n  const startAiListening = () => {\n    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {\n      alert('Speech Recognition not supported in this browser.')\n      return\n    }\n    \n    // Stop any existing recognition first\n    if (aiRecognitionRef.current) {\n      aiRecognitionRef.current.stop()\n      aiRecognitionRef.current.abort()\n    }\n    \n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\n    const recognition = new SpeechRecognition()\n    recognition.lang = 'en-US'\n    recognition.interimResults = false\n    recognition.maxAlternatives = 1\n    recognition.continuous = false\n    \n    recognition.onresult = (event) => {\n      const text = event.results[0][0].transcript\n      setAiTranscript(text)\n      setAiQuery(text)\n      stopAiListening() // Auto-stop after getting result\n    }\n    \n    recognition.onend = () => {\n      setAiListening(false)\n      if (aiListeningTimeoutRef.current) {\n        clearTimeout(aiListeningTimeoutRef.current)\n        aiListeningTimeoutRef.current = null\n      }\n    }\n    \n    recognition.onerror = (event) => {\n      console.log('Speech recognition error:', event.error)\n      setAiListening(false)\n      if (aiListeningTimeoutRef.current) {\n        clearTimeout(aiListeningTimeoutRef.current)\n        aiListeningTimeoutRef.current = null\n      }\n    }\n    \n    recognition.onstart = () => {\n      setAiListening(true)\n      // Auto-stop after 30 seconds\n      aiListeningTimeoutRef.current = setTimeout(() => {\n        stopAiListening()\n      }, 30000)\n    }\n    \n    aiRecognitionRef.current = recognition\n    recognition.start()\n  }\n\n  const stopAiListening = () => {\n    if (aiRecognitionRef.current) {\n      try {\n        aiRecognitionRef.current.stop()\n        aiRecognitionRef.current.abort()\n      } catch (e) {\n        console.log('Error stopping recognition:', e)\n      }\n      aiRecognitionRef.current = null\n    }\n    setAiListening(false)\n    if (aiListeningTimeoutRef.current) {\n      clearTimeout(aiListeningTimeoutRef.current)\n      aiListeningTimeoutRef.current = null\n    }\n  }\n\n  // Voice input logic\n  const startListening = () => {\n    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {\n      alert('Speech Recognition not supported in this browser.')\n      return\n    }\n    \n    // Stop any existing recognition first\n    if (recognitionRef.current) {\n      recognitionRef.current.stop()\n      recognitionRef.current.abort()\n    }\n    \n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\n    const recognition = new SpeechRecognition()\n    recognition.lang = 'en-US'\n    recognition.interimResults = false\n    recognition.maxAlternatives = 1\n    recognition.continuous = false\n    \n    recognition.onresult = (event) => {\n      const text = event.results[0][0].transcript\n      setTranscript(text)\n      setUserInput(userInput ? userInput + '\\n' + text : text)\n      stopListening() // Auto-stop after getting result\n    }\n    \n    recognition.onend = () => {\n      setIsListening(false)\n      if (listeningTimeoutRef.current) {\n        clearTimeout(listeningTimeoutRef.current)\n        listeningTimeoutRef.current = null\n      }\n    }\n    \n    recognition.onerror = (event) => {\n      console.log('Speech recognition error:', event.error)\n      setIsListening(false)\n      if (listeningTimeoutRef.current) {\n        clearTimeout(listeningTimeoutRef.current)\n        listeningTimeoutRef.current = null\n      }\n    }\n    \n    recognition.onstart = () => {\n      setIsListening(true)\n      // Auto-stop after 30 seconds\n      listeningTimeoutRef.current = setTimeout(() => {\n        stopListening()\n      }, 30000)\n    }\n    \n    recognitionRef.current = recognition\n    recognition.start()\n  }\n\n  const stopListening = () => {\n    if (recognitionRef.current) {\n      try {\n        recognitionRef.current.stop()\n        recognitionRef.current.abort()\n      } catch (e) {\n        console.log('Error stopping recognition:', e)\n      }\n      recognitionRef.current = null\n    }\n    setIsListening(false)\n    if (listeningTimeoutRef.current) {\n      clearTimeout(listeningTimeoutRef.current)\n      listeningTimeoutRef.current = null\n    }\n  }\n\n  // Custom voice modal functions\n  const openVoiceModal = () => {\n    setShowVoiceModal(true)\n    setVoiceModalText('')\n    setVoiceModalListening(false)\n  }\n\n  const closeVoiceModal = () => {\n    setShowVoiceModal(false)\n    if (voiceModalRecognitionRef.current) {\n      voiceModalRecognitionRef.current.stop()\n      voiceModalRecognitionRef.current.abort()\n    }\n    setVoiceModalListening(false)\n  }\n\n  const startVoiceModalListening = () => {\n    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {\n      alert('Speech Recognition not supported in this browser.')\n      return\n    }\n    \n    if (voiceModalRecognitionRef.current) {\n      voiceModalRecognitionRef.current.stop()\n      voiceModalRecognitionRef.current.abort()\n    }\n    \n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\n    const recognition = new SpeechRecognition()\n    recognition.lang = 'en-US'\n    recognition.interimResults = true\n    recognition.maxAlternatives = 1\n    recognition.continuous = false\n    \n    recognition.onresult = (event) => {\n      const transcript = Array.from(event.results)\n        .map(result => result[0])\n        .map(result => result.transcript)\n        .join('')\n      setVoiceModalText(transcript)\n    }\n    \n    recognition.onend = () => {\n      setVoiceModalListening(false)\n      // Auto-focus the text area for editing after speaking\n      setTimeout(() => {\n        const textArea = document.getElementById('voice-modal-textarea')\n        if (textArea) textArea.focus()\n      }, 100)\n    }\n    \n    recognition.onerror = (event) => {\n      console.log('Voice modal error:', event.error)\n      setVoiceModalListening(false)\n    }\n    \n    recognition.onstart = () => {\n      setVoiceModalListening(true)\n      setVoiceModalText('') // Clear previous text when starting\n    }\n    \n    voiceModalRecognitionRef.current = recognition\n    recognition.start()\n  }\n\n  const stopVoiceModalListening = () => {\n    if (voiceModalRecognitionRef.current) {\n      voiceModalRecognitionRef.current.stop()\n      voiceModalRecognitionRef.current.abort()\n    }\n    setVoiceModalListening(false)\n  }\n\n  const applyVoiceModalText = () => {\n    if (voiceModalText.trim()) {\n      setUserInput(userInput ? userInput + '\\n' + voiceModalText : voiceModalText)\n    }\n    closeVoiceModal()\n  }\n\n  return (\n    <div className=\"shopping-container\">\n      <h1>Shopping List</h1>\n      <div style={{ marginBottom: 24, padding: 16, background: LIFETIME_COLORS.background, borderRadius: 16, boxShadow: '0 2px 12px #bfc1c2', border: `1px solid ${LIFETIME_COLORS.accent}` }}>\n        <h2 style={{ marginBottom: 8, color: LIFETIME_COLORS.primary, fontWeight: 800 }}>Smart Shopping Assistant</h2>\n        <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\n          <input\n            type=\"text\"\n            placeholder=\"Ask e.g. 'What should I buy this month?'\"\n            value={aiQuery}\n            onChange={e => setAiQuery(e.target.value)}\n            style={{ flex: 1, padding: 12, borderRadius: 12, border: `1.5px solid ${LIFETIME_COLORS.accent}`, fontSize: 18, background: LIFETIME_COLORS.white, color: LIFETIME_COLORS.black, boxShadow: '0 1px 4px #e6f4ea' }}\n            onKeyDown={e => { if (e.key === 'Enter') handleAiQuery() }}\n          />\n          <button\n            onClick={aiListening ? stopAiListening : startAiListening}\n            style={{\n              background: aiListening ? LIFETIME_COLORS.primary : LIFETIME_COLORS.accent,\n              color: aiListening ? LIFETIME_COLORS.white : LIFETIME_COLORS.primary,\n              border: 'none',\n              borderRadius: '50%',\n              width: 44,\n              height: 44,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              boxShadow: aiListening ? `0 0 8px 2px ${LIFETIME_COLORS.primary}` : 'none',\n              animation: aiListening ? 'pulse 1s infinite' : 'none',\n              cursor: 'pointer',\n              outline: 'none',\n              transition: 'all 0.2s'\n            }}\n            title={aiListening ? 'Stop Listening' : 'Start Voice Input'}\n          >\n            {aiListening ? <Square size={24} /> : <Mic size={24} />}\n          </button>\n          <button onClick={handleAiQuery} disabled={aiProcessing} style={{ padding: '12px 24px', borderRadius: 12, background: LIFETIME_COLORS.primary, color: LIFETIME_COLORS.white, border: 'none', fontWeight: 700, fontSize: 18, boxShadow: '0 1px 4px #bfc1c2' }}>\n            {aiProcessing ? 'Thinking...' : 'Ask AI'}\n          </button>\n        </div>\n        {aiListening && <span style={{ color: LIFETIME_COLORS.primary, fontWeight: 600, marginLeft: 8 }}>Listening...</span>}\n        {aiTranscript && !aiListening && (\n          <span style={{ color: LIFETIME_COLORS.primary, marginLeft: 8 }}>Heard: \"{aiTranscript}\"</span>\n        )}\n        {aiResponse && <div style={{ marginTop: 16, color: LIFETIME_COLORS.primary, background: LIFETIME_COLORS.highlight, padding: 14, borderRadius: 10, fontSize: 17, fontWeight: 500 }}>{aiResponse}</div>}\n      </div>\n      <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\n        <button onClick={() => setActiveList('main')} style={{ fontWeight: activeList === 'main' ? 'bold' : 'normal' }}>Main List</button>\n        <button onClick={() => setActiveList('misc')} style={{ fontWeight: activeList === 'misc' ? 'bold' : 'normal' }}>Misc List</button>\n      </div>\n      <div style={{ marginBottom: 16 }}>\n        <h3>Shopping Analytics</h3>\n        <div>Total items: {analytics.total || 0}</div>\n        <div>Completed: {analytics.completed || 0}</div>\n        <div>By Category: {Object.entries(analytics.byCategory || {}).map(([cat, n]) => `${cat}: ${n}`).join(', ')}</div>\n        {reminder && <div style={{ color: 'orange', fontWeight: 600 }}>{reminder}</div>}\n      </div>\n      <div className=\"shopping-list-container\">\n        {Object.entries((activeList === 'main' ? mainList : miscList).reduce((acc, item) => {\n          acc[item.category] = acc[item.category] || []\n          acc[item.category].push(item)\n          return acc\n        }, {})).map(([cat, items]) => (\n          <div key={cat} style={{ marginBottom: 16 }}>\n            <div style={{ display: 'flex', alignItems: 'center', fontWeight: 700, fontSize: 18, marginBottom: 4 }}>\n              {CATEGORY_ICONS[cat] || null}{cat}\n        </div>\n            {items.map((item, idx) => (\n              <div key={idx} style={{ display: 'flex', alignItems: 'center', gap: 8, background: '#f1f5f9', borderRadius: 6, padding: 6, marginBottom: 2 }}>\n                <span>{item.quantity}x {item.name}</span>\n                {item.brand && <span>({item.brand})</span>}\n                {item.grainger_part && (\n                  <a href={item.grainger_url} target=\"_blank\" rel=\"noopener noreferrer\" title=\"View on Grainger\">\n                    <Store size={16} />\n                  </a>\n                )}\n                {item.home_depot_aisle && (\n                  <a href={`https://www.homedepot.com/s/search?q=${item.name}`} target=\"_blank\" rel=\"noopener noreferrer\" title=\"View on Home Depot\">\n                    <MapPin size={16} />\n                  </a>\n                )}\n                {activeList === 'main' && (\n                  <button onClick={() => moveToMisc(idx)} title=\"Move to Misc\" style={{ marginLeft: 8 }}>\n                    Move to Misc\n                  </button>\n                )}\n              </div>\n            ))}\n          </div>\n        ))}\n        </div>\n\n      <div className=\"input-section\">\n        <h2>Add Items</h2>\n        <div className=\"input-group\">\n          <input\n            type=\"text\"\n            placeholder={`Add item to ${activeList} list (e.g., \"10x LED bulbs\")`}\n            value={userInput}\n            onChange={(e) => setUserInput(e.target.value)}\n            onKeyPress={(e) => {\n              if (e.key === 'Enter') {\n                processShoppingInput()\n              }\n            }}\n          />\n          <button\n            onClick={openVoiceModal}\n            style={{\n              background: LIFETIME_COLORS.accent,\n              color: LIFETIME_COLORS.primary,\n              border: 'none',\n              borderRadius: '50%',\n              width: 40,\n              height: 40,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              cursor: 'pointer',\n              outline: 'none',\n              transition: 'all 0.2s'\n            }}\n            title=\"Voice Input\"\n          >\n            <Mic size={20} />\n          </button>\n          <button onClick={processShoppingInput} disabled={processing}>\n            {processing ? <Loader className=\"loader\" /> : <Plus />}\n          </button>\n        </div>\n      </div>\n      {suggestedItems.length > 0 && (\n        <div style={{ marginTop: 16, background: '#f6f6f6', padding: 12, borderRadius: 8 }}>\n          <b>AI Suggestions:</b> {suggestedItems.join(', ')}\n        </div>\n      )}\n\n      {message.text && (\n        <div className={`message-box ${message.type}`}>\n          {message.text}\n        </div>\n      )}\n      {showVoiceModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'rgba(0,0,0,0.5)',\n                          display: 'flex', \n                          alignItems: 'center', \n          justifyContent: 'center',\n          zIndex: 1000\n        }}>\n                        <div style={{ \n            background: LIFETIME_COLORS.white,\n            padding: 24,\n            borderRadius: 16,\n            boxShadow: '0 4px 20px rgba(0,0,0,0.3)',\n            maxWidth: 500,\n            width: '90%',\n            textAlign: 'center'\n          }}>\n            <h3 style={{ color: LIFETIME_COLORS.primary, marginBottom: 16 }}>Voice Input</h3>\n            \n            <div style={{ marginBottom: 16 }}>\n                    <button\n                onClick={voiceModalListening ? stopVoiceModalListening : startVoiceModalListening}\n                          style={{\n                  background: voiceModalListening ? LIFETIME_COLORS.primary : LIFETIME_COLORS.accent,\n                  color: voiceModalListening ? LIFETIME_COLORS.white : LIFETIME_COLORS.primary,\n                            border: 'none',\n                  borderRadius: '50%',\n                  width: 60,\n                  height: 60,\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  margin: '0 auto',\n                  boxShadow: voiceModalListening ? `0 0 12px 4px ${LIFETIME_COLORS.primary}` : 'none',\n                  animation: voiceModalListening ? 'pulse 1s infinite' : 'none',\n                            cursor: 'pointer',\n                  outline: 'none',\n                  transition: 'all 0.2s'\n                }}\n              >\n                {voiceModalListening ? <Square size={30} /> : <Mic size={30} />}\n                        </button>\n              <p style={{ marginTop: 8, color: LIFETIME_COLORS.primary, fontWeight: 600 }}>\n                {voiceModalListening ? 'Listening... Click to stop' : 'Click to start speaking'}\n              </p>\n                          </div>\n                          \n            <div style={{ marginBottom: 16 }}>\n              <label style={{ display: 'block', textAlign: 'left', marginBottom: 8, color: LIFETIME_COLORS.primary, fontWeight: 600 }}>\n                Edit your text:\n              </label>\n              <textarea\n                id=\"voice-modal-textarea\"\n                value={voiceModalText}\n                onChange={(e) => setVoiceModalText(e.target.value)}\n                placeholder=\"Speak to add items to your shopping list...\"\n                style={{\n                  width: '100%',\n                  minHeight: 100,\n                  padding: 12,\n                  borderRadius: 8,\n                  border: `1.5px solid ${LIFETIME_COLORS.accent}`,\n                  fontSize: 16,\n                  fontFamily: 'inherit',\n                  resize: 'vertical',\n                  background: LIFETIME_COLORS.white,\n                  color: LIFETIME_COLORS.black\n                }}\n              />\n                            </div>\n                            \n            <div style={{ display: 'flex', gap: 8, justifyContent: 'center' }}>\n              <button\n                onClick={closeVoiceModal}\n                style={{\n                  padding: '10px 20px',\n                  borderRadius: 8,\n                  border: `1px solid ${LIFETIME_COLORS.accent}`,\n                  background: LIFETIME_COLORS.white,\n                  color: LIFETIME_COLORS.primary,\n                  cursor: 'pointer',\n                  fontWeight: 600\n                }}\n              >\n                Cancel\n              </button>\n              <button\n                onClick={applyVoiceModalText}\n                disabled={!voiceModalText.trim()}\n                style={{\n                  padding: '10px 20px',\n                  borderRadius: 8,\n                  background: LIFETIME_COLORS.primary,\n                  color: LIFETIME_COLORS.white,\n                  border: 'none',\n                  cursor: voiceModalText.trim() ? 'pointer' : 'not-allowed',\n                  opacity: voiceModalText.trim() ? 1 : 0.5,\n                  fontWeight: 600\n                }}\n              >\n                Add to List\n              </button>\n                          </div>\n                        </div>\n          </div>\n        )}\n    </div>\n  )\n}\n\nexport default Shopping "],"names":["LIFETIME_COLORS","Shopping","shoppingLists","setShoppingLists","useState","tasks","setTasks","loading","setLoading","message","setMessage","isOnline","setIsOnline","userInput","setUserInput","processing","setProcessing","selectedTaskId","setSelectedTaskId","isListening","setIsListening","transcript","setTranscript","useRef","activeList","setActiveList","mainList","setMainList","miscList","setMiscList","suggestedItems","setSuggestedItems","analytics","setAnalytics","reminder","setReminder","aiQuery","setAiQuery","aiResponse","setAiResponse","aiProcessing","setAiProcessing","aiListening","setAiListening","aiTranscript","setAiTranscript","aiRecognitionRef","aiListeningTimeoutRef","showVoiceModal","setShowVoiceModal","voiceModalText","setVoiceModalText","voiceModalListening","setVoiceModalListening","voiceModalRecognitionRef","CATEGORY_KEYWORDS","SUGGESTIONS","CATEGORY_ICONS","Lightbulb","Droplet","Paintbrush","Wrench","HelpCircle","useEffect","handleOnline","handleOffline","loadShoppingLists","loadTasks","main","misc","voiceShopping","processShoppingInput","data","error","supabase","TABLES","showMessage","perplexityApiKey","API_KEYS","items","line","itemLine","match","quantity","name","brand","brandMatch","addItemToActiveList","response","messageContent","parsedItems","categorized","item","category","cat","keywords","k","suggestions","key","suggs","allItems","freq","i","frequent","_","count","completed","total","byCategory","prev","moveToMisc","index","type","text","handleAiQuery","history","prompt","startAiListening","SpeechRecognition","recognition","event","stopAiListening","e","openVoiceModal","closeVoiceModal","startVoiceModalListening","result","textArea","stopVoiceModalListening","applyVoiceModalText","jsxs","jsx","Square","Mic","acc","idx","Store","MapPin","Loader","Plus"],"mappings":"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"}