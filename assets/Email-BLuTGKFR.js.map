{"version":3,"file":"Email-BLuTGKFR.js","sources":["../../src/components/Email.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { supabase, TABLES, API_KEYS } from '../lib/supabase'\nimport { \n  Send, \n  MessageSquare, \n  RotateCcw, \n  Brain, \n  Copy, \n  FileText,\n  Mic,\n  Square,\n  Mail,\n  Users,\n  Clock,\n  Star,\n  Trash2,\n  Archive,\n  Reply,\n  Forward,\n  Edit,\n  Save,\n  X\n} from 'lucide-react'\n\nconst Email = () => {\n  console.log('Rendering Email')\n  console.log('Email rendering!')\n  const [emails, setEmails] = useState([])\n  const [loading, setLoading] = useState(false)\n  const [message, setMessage] = useState({ type: '', text: '' })\n  \n  const [emailForm, setEmailForm] = useState({\n    to: '',\n    subject: '',\n    body: ''\n  })\n\n  // Email context state for replies\n  const [emailContext, setEmailContext] = useState({\n    pastedContent: '',\n    generatedReply: '',\n    showContextForm: false\n  })\n\n  // Voice input state\n  const [isListening, setIsListening] = useState(false)\n  const [transcript, setTranscript] = useState('')\n  const [listeningTimeout, setListeningTimeout] = useState(null)\n  const [showVoiceModal, setShowVoiceModal] = useState(false)\n  const [voiceModalText, setVoiceModalText] = useState('')\n  const [voiceModalListening, setVoiceModalListening] = useState(false)\n  const [voiceModalRecognitionRef, setVoiceModalRecognitionRef] = useState(null)\n  const [voiceMode, setVoiceMode] = useState('body') // 'body', 'subject', 'to'\n\n  // AI features state\n  const [aiSuggestions, setAiSuggestions] = useState([])\n  const [emailTemplates, setEmailTemplates] = useState([])\n  const [showTemplates, setShowTemplates] = useState(false)\n\n  // Load emails on component mount\n  useEffect(() => {\n    loadEmails()\n  }, [])\n\n  // Handle voice commands\n  useEffect(() => {\n    const voiceEmail = localStorage.getItem('voiceEmail')\n    if (voiceEmail) {\n      try {\n        const emailData = JSON.parse(voiceEmail)\n        if (emailData.recipient) {\n          setEmailForm(prev => ({ ...prev, recipient: emailData.recipient }))\n        }\n        if (emailData.subject) {\n          setEmailForm(prev => ({ ...prev, subject: emailData.subject }))\n        }\n        localStorage.removeItem('voiceEmail')\n      } catch (error) {\n        console.error('Error parsing voice email data:', error)\n        localStorage.removeItem('voiceEmail')\n      }\n    }\n  }, [])\n\n  const loadEmails = async () => {\n    try {\n      const { data, error } = await supabase\n        .from(TABLES.EMAILS)\n        .select('*')\n        .order('created_at', { ascending: false })\n\n      if (error) throw error\n      setEmails(data || [])\n    } catch (error) {\n      console.error('Error loading emails:', error)\n      console.log('Email component: Data load failed, showing fallback')\n      showMessage('error', 'Failed to load emails')\n      setEmails([]) // Ensure empty state for fallback\n    }\n  }\n\n  const sendEmail = async (e) => {\n    e.preventDefault()\n    if (!emailForm.to || !emailForm.subject || !emailForm.body) {\n      showMessage('error', 'Please fill in all fields')\n      return\n    }\n\n    try {\n      setLoading(true)\n      \n      // Call Supabase Function to send email via Resend\n      const { data, error } = await supabase.functions.invoke('send-email', {\n        body: {\n          to: emailForm.to,\n          subject: emailForm.subject,\n          text: emailForm.body\n        }\n      })\n\n      if (error) throw error\n\n      // Save email to database\n      const { data: emailData, error: dbError } = await supabase\n        .from(TABLES.EMAILS)\n        .insert([{\n          user_id: 'current-user', // Replace with actual user ID\n          to_email: emailForm.to,\n          subject: emailForm.subject,\n          body: emailForm.body,\n          sent: true\n        }])\n        .select()\n\n      if (dbError) throw dbError\n\n      // Update local state\n      setEmails([emailData[0], ...emails])\n      setEmailForm({ to: '', subject: '', body: '' })\n      \n      // Log success\n      console.log(`Email sent to ${emailForm.to}`)\n      showMessage('success', `Email sent successfully to ${emailForm.to}`)\n      \n    } catch (error) {\n      console.error('Error sending email:', error)\n      showMessage('error', 'Failed to send email')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const respondToEmail = async (emailId, context) => {\n    try {\n      setLoading(true)\n      \n      // Fetch task data from Supabase for context (limit to 5 for token optimization)\n      const { data: tasks, error: tasksError } = await supabase\n        .from(TABLES.TASKS)\n        .select('*')\n        .eq('user_id', 'current-user') // Replace with actual user ID\n        .order('created_at', { ascending: false })\n        .limit(5) // Reduced to 5 tasks for token optimization\n\n      if (tasksError) {\n        console.error('Error fetching tasks:', tasksError)\n        showMessage('error', 'Failed to fetch task data')\n        return\n      }\n\n      console.log('Fetched tasks for Claude context:', tasks)\n\n      // Generate response using Claude 4.0 Max API with task context\n      const response = await generateEmailResponseWithClaude(context, tasks)\n      \n      // Send the response email\n      const { data, error } = await supabase.functions.invoke('send-email', {\n        body: {\n          to: context.to_email || 'sender@example.com',\n          subject: `Re: ${context.subject}`,\n          text: response\n        }\n      })\n\n      if (error) throw error\n\n      // Save response to database\n      const { data: emailData, error: dbError } = await supabase\n        .from(TABLES.EMAILS)\n        .insert([{\n          user_id: 'current-user',\n          to_email: context.to_email || 'sender@example.com',\n          subject: `Re: ${context.subject}`,\n          body: response,\n          sent: true\n        }])\n        .select()\n\n      if (dbError) throw dbError\n\n      setEmails([emailData[0], ...emails])\n      console.log(`Response sent to ${context.to_email || 'sender@example.com'}`)\n      showMessage('success', 'Response sent successfully')\n      \n    } catch (error) {\n      console.error('Error sending response:', error)\n      showMessage('error', 'Failed to send response')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const generateReplyWithContext = async () => {\n    if (!emailContext.pastedContent.trim()) {\n      showMessage('error', 'Please paste email content first')\n      return\n    }\n\n    try {\n      setLoading(true)\n      \n      // Fetch task data from Supabase for context (limit to 5 for token optimization)\n      const { data: tasks, error: tasksError } = await supabase\n        .from(TABLES.TASKS)\n        .select('*')\n        .eq('user_id', 'current-user') // Replace with actual user ID\n        .order('created_at', { ascending: false })\n        .limit(5) // Reduced to 5 tasks for token optimization\n\n      if (tasksError) {\n        console.error('Error fetching tasks:', tasksError)\n        showMessage('error', 'Failed to fetch task data')\n        return\n      }\n\n      console.log('Fetched tasks for context reply:', tasks)\n\n      // Generate reply using Claude with pasted content and tasks\n      const reply = await generateContextualReply(emailContext.pastedContent, tasks)\n      \n      setEmailContext(prev => ({ ...prev, generatedReply: reply }))\n      console.log('Reply generated with context')\n      showMessage('success', 'Reply generated successfully')\n      \n    } catch (error) {\n      console.error('Error generating reply:', error)\n      showMessage('error', 'Failed to generate reply')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const sendGeneratedReply = async () => {\n    if (!emailContext.generatedReply.trim()) {\n      showMessage('error', 'Please generate a reply first')\n      return\n    }\n\n    try {\n      setLoading(true)\n      \n      // Extract recipient from pasted content or use default\n      const recipient = extractRecipientFromContent(emailContext.pastedContent) || 'recipient@example.com'\n      const subject = extractSubjectFromContent(emailContext.pastedContent) || 'Re: Maintenance Update'\n      \n      // Send the generated reply\n      const { data, error } = await supabase.functions.invoke('send-email', {\n        body: {\n          to: recipient,\n          subject: subject,\n          text: emailContext.generatedReply\n        }\n      })\n\n      if (error) throw error\n\n      // Save reply to database\n      const { data: emailData, error: dbError } = await supabase\n        .from(TABLES.EMAILS)\n        .insert([{\n          user_id: 'current-user',\n          to_email: recipient,\n          subject: subject,\n          body: emailContext.generatedReply,\n          sent: true\n        }])\n        .select()\n\n      if (dbError) throw dbError\n\n      setEmails([emailData[0], ...emails])\n      console.log(`Generated reply sent to ${recipient}`)\n      showMessage('success', 'Reply sent successfully')\n      \n      // Reset context form\n      setEmailContext({\n        pastedContent: '',\n        generatedReply: '',\n        showContextForm: false\n      })\n      \n    } catch (error) {\n      console.error('Error sending generated reply:', error)\n      showMessage('error', 'Failed to send reply')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const generateContextualReply = async (pastedContent, tasksData) => {\n    try {\n      const claudeApiKey = API_KEYS.CLAUDE_API\n      \n      if (!claudeApiKey || claudeApiKey === 'sk-ant-api03-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx') {\n        console.warn('Claude API key not configured, using fallback response')\n        return generateFallbackContextualReply(pastedContent, tasksData)\n      }\n\n      // Prepare task context for Claude (optimized for token usage)\n      const tasksContext = tasksData.map(task => \n        `- ${task.task_list} (${task.status})`\n      ).join('\\n')\n\n      const prompt = `Generate a professional email reply based on this context:\n\nOriginal Email:\n${pastedContent}\n\nCurrent Maintenance Tasks (last 5):\n${tasksContext}\n\nInstructions:\n1. Create a concise, professional reply\n2. Reference relevant maintenance tasks when applicable\n3. Ask for specific updates if mentioned (e.g., windscreen, concrete project)\n4. Keep response under 150 words\n5. Use professional tone\n\nReply:`\n\n      console.log('Sending contextual reply request to Claude API...')\n\n      const response = await fetch('https://api.anthropic.com/v1/messages', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-api-key': claudeApiKey,\n          'anthropic-version': '2023-06-01'\n        },\n        body: JSON.stringify({\n          model: 'claude-3-5-sonnet-20240620',\n          max_tokens: 500, // Reduced for token optimization\n          messages: [\n            {\n              role: 'user',\n              content: prompt\n            }\n          ]\n        })\n      })\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('Claude API error:', response.status, errorText)\n        throw new Error(`Claude API error: ${response.status}`)\n      }\n\n      const result = await response.json()\n      const generatedReply = result.content[0].text\n\n      console.log('Contextual reply generated successfully')\n      return generatedReply\n\n    } catch (error) {\n      console.error('Error calling Claude API:', error)\n      console.log('Using fallback contextual reply due to Claude API error')\n      return generateFallbackContextualReply(pastedContent, tasksData)\n    }\n  }\n\n  const generateFallbackContextualReply = (pastedContent, tasksData) => {\n    // Fallback response when Claude API is not available\n    const taskSummary = tasksData.length > 0 \n      ? `\\n\\nCurrent maintenance status: ${tasksData.length} active tasks.`\n      : '\\n\\nNo active maintenance tasks at this time.'\n\n    return `Thank you for your email.\n\nI have reviewed your message and will address your concerns promptly.${taskSummary}\n\nI'll follow up with you shortly with more detailed information.\n\nBest regards,\nMaintenance Team`\n  }\n\n  const extractRecipientFromContent = (content) => {\n    // Simple extraction - look for email patterns\n    const emailMatch = content.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/)\n    return emailMatch ? emailMatch[0] : null\n  }\n\n  const extractSubjectFromContent = (content) => {\n    // Simple extraction - look for subject line\n    const subjectMatch = content.match(/Subject:\\s*(.+)/i)\n    return subjectMatch ? `Re: ${subjectMatch[1]}` : null\n  }\n\n  const generateEmailResponseWithClaude = async (emailContext, tasksData) => {\n    try {\n      const claudeApiKey = API_KEYS.CLAUDE_API\n      \n      if (!claudeApiKey || claudeApiKey === 'sk-ant-api03-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx') {\n        console.warn('Claude API key not configured, using fallback response')\n        return generateFallbackResponse(emailContext, tasksData)\n      }\n\n      // Prepare task context for Claude\n      const tasksContext = tasksData.map(task => \n        `- ${task.task_list} (Status: ${task.status}, Due: ${task.due_date || 'No due date'})`\n      ).join('\\n')\n\n      const prompt = `You are a professional maintenance team member at Lifetime Fitness. Generate a professional email response based on the following context:\n\nOriginal Email Subject: ${emailContext.subject}\nOriginal Email Body: ${emailContext.body}\n\nCurrent Maintenance Tasks:\n${tasksContext}\n\nPlease generate a professional, helpful response that:\n1. Addresses the original email appropriately\n2. References relevant maintenance tasks when applicable\n3. Maintains a professional tone\n4. Provides clear next steps or information\n5. Is concise but comprehensive\n\nResponse:`\n\n      console.log('Sending request to Claude API with context...')\n\n      const response = await fetch('https://api.anthropic.com/v1/messages', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-api-key': claudeApiKey,\n          'anthropic-version': '2023-06-01'\n        },\n        body: JSON.stringify({\n          model: 'claude-3-5-sonnet-20240620',\n          max_tokens: 1000,\n          messages: [\n            {\n              role: 'user',\n              content: prompt\n            }\n          ]\n        })\n      })\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('Claude API error:', response.status, errorText)\n        throw new Error(`Claude API error: ${response.status}`)\n      }\n\n      const result = await response.json()\n      const generatedResponse = result.content[0].text\n\n      console.log('Claude response generated successfully')\n      return generatedResponse\n\n    } catch (error) {\n      console.error('Error calling Claude API:', error)\n      console.log('Using fallback response due to Claude API error')\n      return generateFallbackResponse(emailContext, tasksData)\n    }\n  }\n\n  const generateFallbackResponse = (emailContext, tasksData) => {\n    // Fallback response when Claude API is not available\n    const taskSummary = tasksData.length > 0 \n      ? `\\n\\nCurrent maintenance status: ${tasksData.length} active tasks, including ${tasksData.filter(t => t.status === 'pending').length} pending items.`\n      : '\\n\\nNo active maintenance tasks at this time.'\n\n    return `Thank you for your email regarding \"${emailContext.subject}\".\n\nI have reviewed your message and will address your concerns promptly.${taskSummary}\n\nI'll follow up with you shortly with more detailed information.\n\nBest regards,\nMaintenance Team`\n  }\n\n  const showMessage = (type, text) => {\n    setMessage({ type, text })\n    setTimeout(() => setMessage({ type: '', text: '' }), 5000)\n  }\n\n  // Voice Input Functions\n  const startListening = (mode = 'body') => {\n    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {\n      showMessage('error', 'Speech recognition not supported')\n      return\n    }\n\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\n    const recognition = new SpeechRecognition()\n    \n    recognition.continuous = false\n    recognition.interimResults = true\n    recognition.lang = 'en-US'\n\n    recognition.onstart = () => {\n      setIsListening(true)\n      setTranscript('')\n      setVoiceMode(mode)\n    }\n\n    recognition.onresult = (event) => {\n      let finalTranscript = ''\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        if (event.results[i].isFinal) {\n          finalTranscript += event.results[i][0].transcript\n        }\n      }\n      if (finalTranscript) {\n        setTranscript(finalTranscript)\n        // Apply to appropriate field based on mode\n        if (mode === 'to') {\n          setEmailForm(prev => ({ ...prev, to: finalTranscript }))\n        } else if (mode === 'subject') {\n          setEmailForm(prev => ({ ...prev, subject: finalTranscript }))\n        } else {\n          setEmailForm(prev => ({ ...prev, body: prev.body + ' ' + finalTranscript }))\n        }\n      }\n    }\n\n    recognition.onend = () => {\n      setIsListening(false)\n    }\n\n    recognition.onerror = (event) => {\n      console.error('Speech recognition error:', event.error)\n      setIsListening(false)\n    }\n\n    // Auto-stop after 30 seconds\n    const timeout = setTimeout(() => {\n      recognition.stop()\n      recognition.abort()\n    }, 30000)\n    setListeningTimeout(timeout)\n\n    recognition.start()\n  }\n\n  const stopListening = () => {\n    if (listeningTimeout) {\n      clearTimeout(listeningTimeout)\n      setListeningTimeout(null)\n    }\n    try {\n      // Stop any active recognition\n      if (window.speechRecognition) {\n        window.speechRecognition.stop()\n        window.speechRecognition.abort()\n      }\n    } catch (error) {\n      console.log('Recognition already stopped')\n    }\n    \n    setIsListening(false)\n    showMessage('info', 'Voice input stopped.')\n  }\n\n  // Voice Modal Functions\n  const openVoiceModal = (mode = 'body') => {\n    setShowVoiceModal(true)\n    setVoiceModalText('')\n    setVoiceMode(mode)\n  }\n\n  const closeVoiceModal = () => {\n    setShowVoiceModal(false)\n    setVoiceModalText('')\n    if (voiceModalRecognitionRef) {\n      voiceModalRecognitionRef.stop()\n      voiceModalRecognitionRef.abort()\n    }\n  }\n\n  const startVoiceModalListening = () => {\n    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {\n      showMessage('error', 'Speech recognition not supported')\n      return\n    }\n\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\n    const recognition = new SpeechRecognition()\n    \n    recognition.continuous = false\n    recognition.interimResults = true\n    recognition.lang = 'en-US'\n\n    recognition.onstart = () => {\n      setVoiceModalListening(true)\n    }\n\n    recognition.onresult = (event) => {\n      let finalTranscript = ''\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        if (event.results[i].isFinal) {\n          finalTranscript += event.results[i][0].transcript\n        }\n      }\n      if (finalTranscript) {\n        setVoiceModalText(prev => prev + finalTranscript + ' ')\n      }\n    }\n\n    recognition.onend = () => {\n      setVoiceModalListening(false)\n    }\n\n    recognition.onerror = (event) => {\n      console.error('Speech recognition error:', event.error)\n      setVoiceModalListening(false)\n    }\n\n    recognition.start()\n    setVoiceModalRecognitionRef(recognition)\n  }\n\n  const stopVoiceModalListening = () => {\n    if (voiceModalRecognitionRef) {\n      voiceModalRecognitionRef.stop()\n      voiceModalRecognitionRef.abort()\n      setVoiceModalListening(false)\n    }\n  }\n\n  const applyVoiceModalText = () => {\n    if (voiceModalText.trim()) {\n      if (voiceMode === 'to') {\n        setEmailForm(prev => ({ ...prev, to: voiceModalText.trim() }))\n      } else if (voiceMode === 'subject') {\n        setEmailForm(prev => ({ ...prev, subject: voiceModalText.trim() }))\n      } else {\n        setEmailForm(prev => ({ ...prev, body: voiceModalText.trim() }))\n      }\n      closeVoiceModal()\n    }\n  }\n\n  // Email Templates\n  const emailTemplatesList = [\n    {\n      name: 'Maintenance Report',\n      subject: 'Maintenance Report - {{date}}',\n      body: 'Dear {{recipient}},\\n\\nPlease find below the maintenance report for {{date}}:\\n\\n{{content}}\\n\\nBest regards,\\n{{sender}}'\n    },\n    {\n      name: 'Equipment Issue',\n      subject: 'Equipment Issue Report - {{equipment}}',\n      body: 'Dear {{recipient}},\\n\\nI am reporting an issue with {{equipment}}:\\n\\nIssue: {{issue}}\\nLocation: {{location}}\\nPriority: {{priority}}\\n\\nPlease advise on next steps.\\n\\nBest regards,\\n{{sender}}'\n    },\n    {\n      name: 'Work Order Request',\n      subject: 'Work Order Request - {{project}}',\n      body: 'Dear {{recipient}},\\n\\nI am requesting a work order for the following project:\\n\\nProject: {{project}}\\nDescription: {{description}}\\nEstimated Time: {{time}}\\nMaterials Needed: {{materials}}\\n\\nPlease review and approve.\\n\\nBest regards,\\n{{sender}}'\n    },\n    {\n      name: 'Safety Concern',\n      subject: 'Safety Concern Report',\n      body: 'Dear {{recipient}},\\n\\nI am reporting a safety concern:\\n\\nIssue: {{issue}}\\nLocation: {{location}}\\nSeverity: {{severity}}\\nImmediate Action Required: {{action}}\\n\\nPlease address as soon as possible.\\n\\nBest regards,\\n{{sender}}'\n    }\n  ]\n\n  const applyEmailTemplate = (template) => {\n    const today = new Date().toLocaleDateString()\n    const processedSubject = template.subject.replace('{{date}}', today)\n    const processedBody = template.body\n      .replace('{{date}}', today)\n      .replace('{{sender}}', 'Maintenance Team')\n    \n    setEmailForm(prev => ({\n      ...prev,\n      subject: processedSubject,\n      body: processedBody\n    }))\n    setShowTemplates(false)\n  }\n\n  // AI Suggestions\n  const generateAiSuggestions = async () => {\n    try {\n      const perplexityApiKey = import.meta.env.VITE_PERPLEXITY_API_KEY\n      if (!perplexityApiKey) {\n        console.log('Perplexity API key not configured')\n        return\n      }\n\n      const emailSummary = emails.map(email => ({\n        to: email.to_email,\n        subject: email.subject,\n        body: email.body,\n        sent: email.sent,\n        created_at: email.created_at\n      }))\n\n      const response = await fetch('https://api.perplexity.ai/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${perplexityApiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4',\n          messages: [\n            {\n              role: 'user',\n              content: `Analyze this email history and provide 3-5 suggestions for improving email communication, templates, or workflow. Return as JSON array with 'suggestion' and 'reason' fields. Emails: ${JSON.stringify(emailSummary)}`\n            }\n          ]\n        })\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        const messageContent = data.choices[0].message.content\n        const suggestions = JSON.parse(messageContent)\n        setAiSuggestions(suggestions)\n      }\n    } catch (error) {\n      console.error('Error generating AI suggestions:', error)\n    }\n  }\n\n  return (\n    <div className=\"container\">\n      {message.text && (\n        <div className={`message ${message.type}`}>\n          {message.text}\n        </div>\n      )}\n\n      <div className=\"card\">\n        <h3>Send Email</h3>\n        <form onSubmit={sendEmail}>\n          <div className=\"form-group\">\n            <label className=\"form-label\" htmlFor=\"email-recipient\">Recipient</label>\n            <input\n              id=\"email-recipient\"\n              name=\"email-recipient\"\n              type=\"email\"\n              className=\"form-input\"\n              value={emailForm.recipient}\n              onChange={(e) => setEmailForm({...emailForm, recipient: e.target.value})}\n              placeholder=\"Enter email address\"\n              required\n            />\n          </div>\n          <div className=\"form-group\">\n            <label className=\"form-label\" htmlFor=\"email-subject\">Subject</label>\n            <input\n              id=\"email-subject\"\n              name=\"email-subject\"\n              type=\"text\"\n              className=\"form-input\"\n              value={emailForm.subject}\n              onChange={(e) => setEmailForm({...emailForm, subject: e.target.value})}\n              placeholder=\"Enter email subject\"\n              required\n            />\n          </div>\n          <div className=\"form-group\">\n            <label className=\"form-label\" htmlFor=\"email-body\">Body</label>\n            <textarea\n              id=\"email-body\"\n              name=\"email-body\"\n              className=\"form-textarea\"\n              value={emailForm.body}\n              onChange={(e) => setEmailForm({...emailForm, body: e.target.value})}\n              placeholder=\"Email content...\"\n              title=\"Email body content\"\n              required\n            />\n          </div>\n          <button type=\"submit\" className=\"btn\" disabled={loading} title=\"Send email\" aria-label=\"Send email\">\n            {loading ? (\n              <>\n                <RotateCcw size={16} style={{ marginRight: '0.5rem', animation: 'spin 1s linear infinite' }} aria-hidden=\"true\" />\n                Sending...\n              </>\n            ) : (\n              <>\n                <Send size={16} style={{ marginRight: '0.5rem' }} aria-hidden=\"true\" />\n                Send Email\n              </>\n            )}\n          </button>\n        </form>\n\n        {/* Voice Input Section */}\n        <div style={{ \n          marginTop: '1rem', \n          padding: '1rem', \n          backgroundColor: isListening ? 'var(--warning-color)' : 'var(--light-color)', \n          borderRadius: '8px',\n          border: isListening ? '2px solid var(--warning-color)' : '1px solid var(--border-color)',\n          textAlign: 'center'\n        }}>\n          <h4 style={{ \n            marginBottom: '0.5rem', \n            color: isListening ? 'white' : 'var(--primary-color)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            gap: '0.5rem'\n          }}>\n            <Mic size={20} />\n            Voice Input\n          </h4>\n          \n          {/* Voice Buttons */}\n          <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'center', marginBottom: '1rem', flexWrap: 'wrap' }}>\n            <button\n              onClick={() => startListening('to')}\n              style={{\n                padding: '0.75rem 1rem',\n                borderRadius: '25px',\n                border: 'none',\n                backgroundColor: isListening && voiceMode === 'to' ? '#dc3545' : 'var(--primary-color)',\n                color: 'white',\n                cursor: 'pointer',\n                fontSize: '0.9rem',\n                fontWeight: '600',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                transition: 'all 0.3s ease'\n              }}\n            >\n              <Users size={16} />\n              To\n            </button>\n            \n            <button\n              onClick={() => startListening('subject')}\n              style={{\n                padding: '0.75rem 1rem',\n                borderRadius: '25px',\n                border: 'none',\n                backgroundColor: isListening && voiceMode === 'subject' ? '#dc3545' : 'var(--primary-color)',\n                color: 'white',\n                cursor: 'pointer',\n                fontSize: '0.9rem',\n                fontWeight: '600',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                transition: 'all 0.3s ease'\n              }}\n            >\n              <FileText size={16} />\n              Subject\n            </button>\n            \n            <button\n              onClick={() => startListening('body')}\n              style={{\n                padding: '0.75rem 1rem',\n                borderRadius: '25px',\n                border: 'none',\n                backgroundColor: isListening && voiceMode === 'body' ? '#dc3545' : 'var(--primary-color)',\n                color: 'white',\n                cursor: 'pointer',\n                fontSize: '0.9rem',\n                fontWeight: '600',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                transition: 'all 0.3s ease'\n              }}\n            >\n              <MessageSquare size={16} />\n              Body\n            </button>\n            \n            <button\n              onClick={openVoiceModal}\n              style={{\n                padding: '0.75rem 1rem',\n                borderRadius: '25px',\n                border: '2px solid var(--primary-color)',\n                backgroundColor: 'white',\n                color: 'var(--primary-color)',\n                cursor: 'pointer',\n                fontSize: '0.9rem',\n                fontWeight: '600',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                transition: 'all 0.3s ease'\n              }}\n            >\n              <Mic size={16} />\n              Modal\n            </button>\n          </div>\n          \n          {/* Voice Status */}\n          {isListening && (\n            <div style={{ \n              color: 'white', \n              fontSize: '0.9rem',\n              marginBottom: '0.5rem',\n              textAlign: 'center',\n              fontWeight: '600'\n            }}>\n              ðŸŽ¤ LISTENING - Click button to stop\n            </div>\n          )}\n          \n          {/* Voice Transcript */}\n          {transcript && (\n            <div style={{ \n              marginTop: '0.5rem',\n              padding: '0.5rem',\n              backgroundColor: 'white',\n              borderRadius: '4px',\n              fontSize: '0.9rem',\n              color: 'var(--text-color)',\n              minHeight: '40px'\n            }}>\n              <strong>You said:</strong> {transcript}\n            </div>\n          )}\n        </div>\n\n        {/* Email Templates */}\n        <div style={{ marginTop: '1rem', padding: '1rem', backgroundColor: 'var(--light-color)', borderRadius: '8px' }}>\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\n            <h4 style={{ color: 'var(--primary-color)', margin: 0 }}>ðŸ“§ Email Templates</h4>\n            <button\n              onClick={() => setShowTemplates(!showTemplates)}\n              style={{\n                padding: '0.5rem 1rem',\n                borderRadius: '4px',\n                border: '1px solid var(--border-color)',\n                backgroundColor: showTemplates ? 'var(--primary-color)' : 'white',\n                color: showTemplates ? 'white' : 'var(--text-color)',\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem'\n              }}\n            >\n              <FileText size={16} />\n              {showTemplates ? 'Hide Templates' : 'Show Templates'}\n            </button>\n          </div>\n          \n          {showTemplates && (\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1rem' }}>\n              {emailTemplatesList.map((template, index) => (\n                <button\n                  key={index}\n                  onClick={() => applyEmailTemplate(template)}\n                  style={{\n                    padding: '1rem',\n                    borderRadius: '8px',\n                    border: '1px solid var(--border-color)',\n                    backgroundColor: 'white',\n                    color: 'var(--text-color)',\n                    cursor: 'pointer',\n                    textAlign: 'left',\n                    transition: 'all 0.2s ease'\n                  }}\n                >\n                  <div style={{ fontWeight: '500', marginBottom: '0.5rem' }}>{template.name}</div>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--secondary-color)' }}>\n                    {template.subject}\n                  </div>\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* AI Suggestions */}\n        <div style={{ marginTop: '1rem', padding: '1rem', backgroundColor: 'var(--light-color)', borderRadius: '8px' }}>\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\n            <h4 style={{ color: 'var(--primary-color)', margin: 0 }}>ðŸ¤– AI Email Suggestions</h4>\n            <button\n              onClick={generateAiSuggestions}\n              style={{\n                padding: '0.5rem 1rem',\n                borderRadius: '4px',\n                border: '1px solid var(--border-color)',\n                backgroundColor: 'var(--primary-color)',\n                color: 'white',\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem'\n              }}\n            >\n              <Brain size={16} />\n              Get AI Suggestions\n            </button>\n          </div>\n          \n          {aiSuggestions.length > 0 && (\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n              {aiSuggestions.map((suggestion, index) => (\n                <div key={index} style={{ \n                  padding: '0.75rem', \n                  backgroundColor: 'white', \n                  borderRadius: '6px',\n                  border: '1px solid var(--border-color)'\n                }}>\n                  <div style={{ fontWeight: '500', marginBottom: '0.25rem' }}>{suggestion.suggestion}</div>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--secondary-color)' }}>{suggestion.reason}</div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Voice Modal */}\n      {showVoiceModal && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0, 0, 0, 0.5)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 1000\n        }}>\n          <div style={{\n            backgroundColor: 'white',\n            padding: '2rem',\n            borderRadius: '12px',\n            width: '90%',\n            maxWidth: '500px',\n            boxShadow: '0 10px 25px rgba(0, 0, 0, 0.2)'\n          }}>\n            <h3 style={{ marginBottom: '1rem', color: 'var(--primary-color)' }}>ðŸŽ¤ Voice Email Input</h3>\n            \n            <div style={{ marginBottom: '1rem' }}>\n              <div style={{ marginBottom: '0.5rem' }}>\n                <label style={{ fontSize: '0.9rem', fontWeight: '500' }}>Mode: {voiceMode}</label>\n              </div>\n              <textarea\n                value={voiceModalText}\n                onChange={(e) => setVoiceModalText(e.target.value)}\n                placeholder=\"Your voice input will appear here...\"\n                style={{\n                  width: '100%',\n                  minHeight: '100px',\n                  padding: '0.75rem',\n                  borderRadius: '8px',\n                  border: '1px solid var(--border-color)',\n                  fontSize: '0.9rem',\n                  resize: 'vertical'\n                }}\n              />\n            </div>\n            \n            <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'center' }}>\n              <button\n                onClick={voiceModalListening ? stopVoiceModalListening : startVoiceModalListening}\n                style={{\n                  padding: '0.75rem 1.5rem',\n                  borderRadius: '8px',\n                  border: 'none',\n                  backgroundColor: voiceModalListening ? '#dc3545' : 'var(--primary-color)',\n                  color: 'white',\n                  cursor: 'pointer',\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '0.5rem'\n                }}\n              >\n                {voiceModalListening ? <Square size={16} /> : <Mic size={16} />}\n                {voiceModalListening ? 'Stop' : 'Start'} Recording\n              </button>\n              \n              <button\n                onClick={applyVoiceModalText}\n                disabled={!voiceModalText.trim()}\n                style={{\n                  padding: '0.75rem 1.5rem',\n                  borderRadius: '8px',\n                  border: 'none',\n                  backgroundColor: voiceModalText.trim() ? 'var(--success-color)' : 'var(--secondary-color)',\n                  color: 'white',\n                  cursor: voiceModalText.trim() ? 'pointer' : 'not-allowed'\n                }}\n              >\n                Apply\n              </button>\n              \n              <button\n                onClick={closeVoiceModal}\n                style={{\n                  padding: '0.75rem 1.5rem',\n                  borderRadius: '8px',\n                  border: '1px solid var(--border-color)',\n                  backgroundColor: 'white',\n                  color: 'var(--text-color)',\n                  cursor: 'pointer'\n                }}\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Email Context Reply Section */}\n      <div className=\"card\">\n        <h3>Generate Reply with Context</h3>\n        <p style={{ color: 'var(--secondary-color)', marginBottom: '1rem' }}>\n          Paste email content to generate a contextual reply using AI and your maintenance tasks.\n        </p>\n        \n        <div className=\"form-group\">\n          <label className=\"form-label\" htmlFor=\"paste-email-content\">Paste Email Content</label>\n          <textarea\n            id=\"paste-email-content\"\n            name=\"paste-email-content\"\n            className=\"form-textarea\"\n            value={emailContext.pastedContent}\n            onChange={(e) => setEmailContext({...emailContext, pastedContent: e.target.value})}\n            placeholder=\"Paste the email content here (e.g., from Split Rail Fencing)...\"\n            rows={6}\n            title=\"Paste email content to generate contextual reply\"\n          />\n        </div>\n\n        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\n          <button\n            className=\"btn\"\n            onClick={generateReplyWithContext}\n            disabled={loading || !emailContext.pastedContent.trim()}\n            title=\"Generate AI reply with context\"\n            aria-label=\"Generate AI reply with context\"\n          >\n            {loading ? (\n              <>\n                <Brain size={16} style={{ marginRight: '0.5rem', animation: 'spin 1s linear infinite' }} aria-hidden=\"true\" />\n                Generating...\n              </>\n            ) : (\n              <>\n                <Brain size={16} style={{ marginRight: '0.5rem' }} aria-hidden=\"true\" />\n                Generate Reply\n              </>\n            )}\n          </button>\n        </div>\n\n        {emailContext.generatedReply && (\n          <div className=\"form-group\">\n            <label className=\"form-label\">Generated Reply</label>\n            <div style={{ \n              padding: '1rem', \n              backgroundColor: 'var(--light-color)', \n              border: '1px solid var(--border-color)',\n              borderRadius: 'var(--border-radius)',\n              marginBottom: '1rem'\n            }}>\n              <div style={{ whiteSpace: 'pre-wrap' }}>\n                {emailContext.generatedReply}\n              </div>\n            </div>\n            <button\n              className=\"btn btn-success\"\n              onClick={sendGeneratedReply}\n              disabled={loading}\n            >\n              <Send size={16} style={{ marginRight: '0.5rem' }} />\n              Send Reply\n            </button>\n          </div>\n        )}\n      </div>\n\n      <div className=\"card\">\n        <h3>Email History</h3>\n        {emails.length === 0 ? (\n          <p style={{ textAlign: 'center', color: 'var(--secondary-color)' }}>\n            No emails sent yet\n          </p>\n        ) : (\n          emails.map(email => (\n            <div key={email.id} className=\"card\" style={{ marginBottom: '1rem' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', gap: '1rem' }}>\n                <div style={{ flex: 1 }}>\n                  <h4>{email.subject}</h4>\n                  <p><strong>To:</strong> {email.to_email}</p>\n                  <p><strong>Date:</strong> {new Date(email.created_at).toLocaleString()}</p>\n                  <p><strong>Status:</strong> \n                    <span style={{ \n                      color: email.sent ? 'var(--success-color)' : 'var(--warning-color)',\n                      fontWeight: '600',\n                      marginLeft: '0.5rem'\n                    }}>\n                      {email.sent ? 'Sent' : 'Draft'}\n                    </span>\n                  </p>\n                  <div style={{ \n                    marginTop: '1rem', \n                    padding: '1rem', \n                    backgroundColor: 'var(--light-color)', \n                    borderRadius: 'var(--border-radius)',\n                    whiteSpace: 'pre-wrap'\n                  }}>\n                    {email.body}\n                  </div>\n                </div>\n                <button\n                  className=\"btn btn-secondary\"\n                  onClick={() => respondToEmail(email.id, email)}\n                  disabled={loading}\n                  style={{ whiteSpace: 'nowrap' }}\n                >\n                  {loading ? (\n                    <>\n                      <Brain size={16} style={{ marginRight: '0.5rem', animation: 'spin 1s linear infinite' }} />\n                      AI Generating...\n                    </>\n                  ) : (\n                    <>\n                      <Brain size={16} style={{ marginRight: '0.5rem' }} />\n                      AI Respond\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      <style jsx>{`\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      `}</style>\n    </div>\n  )\n}\n\nexport default Email "],"names":["Email","emails","setEmails","useState","loading","setLoading","message","setMessage","emailForm","setEmailForm","emailContext","setEmailContext","isListening","setIsListening","transcript","setTranscript","listeningTimeout","setListeningTimeout","showVoiceModal","setShowVoiceModal","voiceModalText","setVoiceModalText","voiceModalListening","setVoiceModalListening","voiceModalRecognitionRef","setVoiceModalRecognitionRef","voiceMode","setVoiceMode","aiSuggestions","setAiSuggestions","emailTemplates","setEmailTemplates","showTemplates","setShowTemplates","useEffect","loadEmails","voiceEmail","emailData","prev","error","data","supabase","TABLES","showMessage","sendEmail","e","dbError","respondToEmail","emailId","context","tasks","tasksError","response","generateEmailResponseWithClaude","generateReplyWithContext","reply","generateContextualReply","sendGeneratedReply","recipient","extractRecipientFromContent","subject","extractSubjectFromContent","pastedContent","tasksData","claudeApiKey","API_KEYS","generateFallbackContextualReply","tasksContext","task","prompt","errorText","generatedReply","content","emailMatch","subjectMatch","generateFallbackResponse","generatedResponse","taskSummary","t","type","text","startListening","mode","SpeechRecognition","recognition","event","finalTranscript","i","timeout","openVoiceModal","closeVoiceModal","startVoiceModalListening","stopVoiceModalListening","applyVoiceModalText","emailTemplatesList","applyEmailTemplate","template","today","processedSubject","processedBody","generateAiSuggestions","jsxs","jsx","Fragment","RotateCcw","Send","Mic","Users","FileText","MessageSquare","index","Brain","suggestion","Square","email"],"mappings":"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"}